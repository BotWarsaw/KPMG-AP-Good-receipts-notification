<Activity mc:Ignorable="sap sap2010" x:Class="Main" mva:VisualBasic.Settings="{x:Null}" sap:VirtualizedContainerService.HintSize="975,1046" sap2010:WorkflowViewState.IdRef="Main2_1" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="27">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>Newtonsoft.Json.Linq</x:String>
      <x:String>Newtonsoft.Json</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
      <x:String>System.Net</x:String>
      <x:String>UiPath.Excel</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="26">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>Microsoft.VisualStudio.Services.Common</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>Newtonsoft.Json</AssemblyReference>
      <AssemblyReference>UiPath.IntelligentOCR</AssemblyReference>
      <AssemblyReference>UiPath.Python</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <Sequence DisplayName="KPMG Attended Framework" sap:VirtualizedContainerService.HintSize="955,946" sap2010:WorkflowViewState.IdRef="Sequence_24">
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <StateMachine InitialState="{x:Reference __ReferenceID3}" sap2010:Annotation.AnnotationText="-- ReFrameWork - Robotic Enterprise Framework --&#xA;-- TEMPLATE--" DisplayName="Private: General Business Process" sap:VirtualizedContainerService.HintSize="913,854" sap2010:WorkflowViewState.IdRef="StateMachine_1">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          <av:Point x:Key="ShapeLocation">260,2.4</av:Point>
          <x:Double x:Key="StateContainerWidth">879.47665375310157</x:Double>
          <x:Double x:Key="StateContainerHeight">775.8</x:Double>
          <av:PointCollection x:Key="ConnectorLocation">290,77.4 290,107.4 286.4,107.4 286.4,135.2</av:PointCollection>
          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <State x:Name="__ReferenceID1" sap2010:Annotation.AnnotationText="Get next transaction input data" DisplayName="Get Transaction Data" sap:VirtualizedContainerService.HintSize="207,142" sap2010:WorkflowViewState.IdRef="State_4">
        <State.Entry>
          <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="763,1647" sap2010:WorkflowViewState.IdRef="TryCatch_8">
            <TryCatch.Try>
              <Sequence sap:VirtualizedContainerService.HintSize="725,1420" sap2010:WorkflowViewState.IdRef="Sequence_38">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:RemoveLogFields DisplayName="Remove Log Fields" sap:VirtualizedContainerService.HintSize="683,22" sap2010:WorkflowViewState.IdRef="RemoveLogFields_1">
                  <ui:RemoveLogFields.Fields>
                    <scg:List x:TypeArguments="InArgument(x:String)" Capacity="4">
                      <InArgument x:TypeArguments="x:String">Entity</InArgument>
                    </scg:List>
                  </ui:RemoveLogFields.Fields>
                </ui:RemoveLogFields>
                <If Condition="[FailedEntitiesCounter&lt;convert.ToInt32(Config(&quot;ConsecutiveEntitiesFailedLimit&quot;))]" sap:VirtualizedContainerService.HintSize="683,389" sap2010:WorkflowViewState.IdRef="If_16">
                  <If.Else>
                    <Sequence sap:VirtualizedContainerService.HintSize="376,241" sap2010:WorkflowViewState.IdRef="Sequence_77">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="New 001 - failed entities limit reached" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_74" UnSafe="False" WorkflowFileName="ErrorHandling\NewExceptionWithCode.xaml">
                        <ui:InvokeWorkflowFile.Arguments>
                          <InArgument x:TypeArguments="x:String" x:Key="in_Message">Consecutive failed entities limit reached</InArgument>
                          <OutArgument x:TypeArguments="s:Exception" x:Key="out_Exception">[SystemError]</OutArgument>
                          <InArgument x:TypeArguments="x:String" x:Key="in_Code">001</InArgument>
                        </ui:InvokeWorkflowFile.Arguments>
                      </ui:InvokeWorkflowFile>
                      <AddToCollection x:TypeArguments="s:Exception" Collection="[ExceptionBuffer]" DisplayName="Add To Collection" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_5" Item="[SystemError]" />
                    </Sequence>
                  </If.Else>
                </If>
                <If Condition="[EntityNumber&lt;EntitiesData.Rows.Count AndAlso FailedEntitiesCounter&lt;convert.ToInt32(Config(&quot;ConsecutiveEntitiesFailedLimit&quot;))]" sap:VirtualizedContainerService.HintSize="683,837" sap2010:WorkflowViewState.IdRef="If_4">
                  <If.Then>
                    <Sequence sap:VirtualizedContainerService.HintSize="376,689" sap2010:WorkflowViewState.IdRef="Sequence_37">
                      <Sequence.Variables>
                        <Variable x:TypeArguments="x:Int32" Name="i" />
                      </Sequence.Variables>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:ForEach x:TypeArguments="x:Object" CurrentIndex="[i]" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="334,277" sap2010:WorkflowViewState.IdRef="ForEach`1_4" Values="[EntitiesData.Rows(EntityNumber).ItemArray]">
                        <ui:ForEach.Body>
                          <ActivityAction x:TypeArguments="x:Object">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="x:Object" Name="item" />
                            </ActivityAction.Argument>
                            <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="242,143" sap2010:WorkflowViewState.IdRef="Sequence_60">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <If Condition="[string.IsNullOrEmpty(item.ToString)]" DisplayName="Throw exception if empty field" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_8">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <Sequence sap:VirtualizedContainerService.HintSize="376,241" sap2010:WorkflowViewState.IdRef="Sequence_59">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="New 112 - missing company config data" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_53" UnSafe="False" WorkflowFileName="ErrorHandling\NewExceptionWithCode.xaml">
                                      <ui:InvokeWorkflowFile.Arguments>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_Message">Missing company config data</InArgument>
                                        <OutArgument x:TypeArguments="s:Exception" x:Key="out_Exception">[SystemError]</OutArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_Code">112</InArgument>
                                      </ui:InvokeWorkflowFile.Arguments>
                                    </ui:InvokeWorkflowFile>
                                    <Throw Exception="[SystemError]" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Throw_5" />
                                  </Sequence>
                                </If.Then>
                              </If>
                            </Sequence>
                          </ActivityAction>
                        </ui:ForEach.Body>
                      </ui:ForEach>
                      <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke GetCompanyData workflow" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_30" UnSafe="False" WorkflowFileName="Global/GetCompanyData.xaml">
                        <ui:InvokeWorkflowFile.Arguments>
                          <OutArgument x:TypeArguments="x:Boolean" x:Key="out_IsMultifactoryCompany">[IsMultifactoryEntity]</OutArgument>
                          <OutArgument x:TypeArguments="x:Boolean" x:Key="out_IsMulticompanyNav">[IsMulticompanyNav]</OutArgument>
                          <OutArgument x:TypeArguments="x:String" x:Key="out_NavPath">[NavPath]</OutArgument>
                          <OutArgument x:TypeArguments="x:String" x:Key="out_FactoryCode">[FactoryCode]</OutArgument>
                          <OutArgument x:TypeArguments="x:String" x:Key="out_CompanyName">[EntityName]</OutArgument>
                          <InArgument x:TypeArguments="sd:DataTable" x:Key="in_CompaniesData">[EntitiesData]</InArgument>
                          <InArgument x:TypeArguments="x:Int32" x:Key="in_CompanyNumber">[EntityNumber]</InArgument>
                          <OutArgument x:TypeArguments="sd:DataRow" x:Key="out_Company">[Entity]</OutArgument>
                          <OutArgument x:TypeArguments="x:String" x:Key="out_CompanySupervisorMail">[EntitySupervisorMail]</OutArgument>
                          <OutArgument x:TypeArguments="x:String" x:Key="out_CompanyReportDirectory">[EntityReportDirectory]</OutArgument>
                        </ui:InvokeWorkflowFile.Arguments>
                      </ui:InvokeWorkflowFile>
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_35" Level="Info" Message="[&quot;Next company: &quot; + EntityName +&quot; - &quot; + FactoryCode]" />
                      <ui:AddLogFields DisplayName="Add Log Fields" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="AddLogFields_2">
                        <ui:AddLogFields.Fields>
                          <InArgument x:TypeArguments="x:String" x:Key="Entity">[EntityName+ " " + FactoryCode]</InArgument>
                        </ui:AddLogFields.Fields>
                      </ui:AddLogFields>
                    </Sequence>
                  </If.Then>
                  <If.Else>
                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_33">
                      <Assign.To>
                        <OutArgument x:TypeArguments="sd:DataRow">[Entity]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="sd:DataRow">[Nothing]</InArgument>
                      </Assign.Value>
                    </Assign>
                  </If.Else>
                </If>
              </Sequence>
            </TryCatch.Try>
            <TryCatch.Catches>
              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="729,21" sap2010:WorkflowViewState.IdRef="Catch`1_9">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ActivityAction x:TypeArguments="s:Exception">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                  </ActivityAction.Argument>
                  <Sequence sap:VirtualizedContainerService.HintSize="376,341" sap2010:WorkflowViewState.IdRef="Sequence_39">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_43">
                      <Assign.To>
                        <OutArgument x:TypeArguments="s:Exception">[SystemError]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="s:Exception">[exception]</InArgument>
                      </Assign.Value>
                    </Assign>
                    <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Set 000 if no flag" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_54" UnSafe="False" WorkflowFileName="ErrorHandling\SetFlagIfNull.xaml">
                      <ui:InvokeWorkflowFile.Arguments>
                        <InArgument x:TypeArguments="x:String" x:Key="in_FlagValue">Code</InArgument>
                        <InOutArgument x:TypeArguments="s:Exception" x:Key="io_SystemError">[SystemError]</InOutArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_Flag">000</InArgument>
                      </ui:InvokeWorkflowFile.Arguments>
                    </ui:InvokeWorkflowFile>
                    <AddToCollection x:TypeArguments="s:Exception" Collection="[ExceptionBuffer]" DisplayName="Add To Collection" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_1" Item="[SystemError]" />
                  </Sequence>
                </ActivityAction>
              </Catch>
            </TryCatch.Catches>
          </TryCatch>
        </State.Entry>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">196.4,402</av:Point>
            <av:Size x:Key="ShapeSize">207,142</av:Size>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
            <x:Double x:Key="StateContainerWidth">172.9622710480532</x:Double>
            <x:Double x:Key="StateContainerHeight">74.984551711340686</x:Double>
            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <State.Exit>
          <ui:InvokeWorkflowFile ContinueOnError="True" DisplayName="Invoke ReportExceptions_Global workflow" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_43" UnSafe="False" WorkflowFileName="ErrorHandling/ReportExceptions_Global.xaml">
            <ui:InvokeWorkflowFile.Arguments>
              <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_Config">[Config]</InArgument>
              <InArgument x:TypeArguments="sd:DataTable" x:Key="in_ExceptionConfig">[ExceptionConfig]</InArgument>
              <InOutArgument x:TypeArguments="scg:List(s:Exception)" x:Key="io_ExceptionList">[GlobalExceptionList]</InOutArgument>
              <InOutArgument x:TypeArguments="scg:List(s:Exception)" x:Key="io_ExceptionBuffer">[ExceptionBuffer]</InOutArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_FactoryCode">[FactoryCode]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_DocumentNo">-</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_ReportPath">[GlobalErrorReportPath]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_CompanyName">[EntityName]</InArgument>
            </ui:InvokeWorkflowFile.Arguments>
          </ui:InvokeWorkflowFile>
        </State.Exit>
        <State.Transitions>
          <Transition sap2010:Annotation.AnnotationText="This is a simple mecanism to stop the process.&#xA;In reallife scenario you can stop the process when there is no more data to process or on a schedule." DisplayName="No Data" sap:VirtualizedContainerService.HintSize="450,562" sap2010:WorkflowViewState.IdRef="Transition_7">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <av:PointCollection x:Key="ConnectorLocation">289.55,544 289.55,574 289.9,574 289.9,666.8</av:PointCollection>
                <x:Int32 x:Key="SrcConnectionPointIndex">35</x:Int32>
                <x:Int32 x:Key="DestConnectionPointIndex">38</x:Int32>
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Transition.To>
              <State x:Name="__ReferenceID0" sap2010:Annotation.AnnotationText="Process stops here" DisplayName="End Process" sap:VirtualizedContainerService.HintSize="484,910" sap2010:WorkflowViewState.IdRef="State_1" IsFinal="True">
                <State.Entry>
                  <TryCatch sap:VirtualizedContainerService.HintSize="438,766" sap2010:WorkflowViewState.IdRef="TryCatch_4">
                    <TryCatch.Try>
                      <Sequence DisplayName="End of process activities" sap:VirtualizedContainerService.HintSize="376,539" sap2010:WorkflowViewState.IdRef="Sequence_20">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="scg:List(s:Exception)" Name="NotificationLevelExceptions" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:InvokeWorkflowFile ContinueOnError="True" DisplayName="Invoke ReportExceptions_Global workflow" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_42" UnSafe="False" WorkflowFileName="ErrorHandling/ReportExceptions_Global.xaml">
                          <ui:InvokeWorkflowFile.Arguments>
                            <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_Config">[Config]</InArgument>
                            <InArgument x:TypeArguments="sd:DataTable" x:Key="in_ExceptionConfig">[ExceptionConfig]</InArgument>
                            <InOutArgument x:TypeArguments="scg:List(s:Exception)" x:Key="io_ExceptionList">[GlobalExceptionList]</InOutArgument>
                            <InOutArgument x:TypeArguments="scg:List(s:Exception)" x:Key="io_ExceptionBuffer">[ExceptionBuffer]</InOutArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="in_FactoryCode">-</InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="in_DocumentNo">-</InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="in_ReportPath">[GlobalErrorReportPath]</InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="in_CompanyName">
                              <Literal x:TypeArguments="x:String" Value="" />
                            </InArgument>
                          </ui:InvokeWorkflowFile.Arguments>
                        </ui:InvokeWorkflowFile>
                        <ui:InvokeWorkflowFile ContinueOnError="True" DisplayName="Invoke FindExceptionsByFlag workflow" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_34" UnSafe="False" WorkflowFileName="ErrorHandling\FindExceptionsByFlag.xaml">
                          <ui:InvokeWorkflowFile.Arguments>
                            <InArgument x:TypeArguments="x:String" x:Key="in_Flag">NotifyGlobalSupervisor</InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="in_FlagValue">TRUE</InArgument>
                            <InArgument x:TypeArguments="scg:List(s:Exception)" x:Key="in_ExceptionList">[GlobalExceptionList]</InArgument>
                            <OutArgument x:TypeArguments="scg:List(s:Exception)" x:Key="out_FoundExceptions">[NotificationLevelExceptions]</OutArgument>
                          </ui:InvokeWorkflowFile.Arguments>
                        </ui:InvokeWorkflowFile>
                        <Sequence DisplayName="Send exception mail" sap:VirtualizedContainerService.HintSize="334,66" sap2010:WorkflowViewState.IdRef="Sequence_65">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <If Condition="[NotificationLevelExceptions.Count&gt;0 Or SendCriticalExceptionMail]" sap:VirtualizedContainerService.HintSize="484,214" sap2010:WorkflowViewState.IdRef="If_9">
                            <If.Then>
                              <Sequence DisplayName="Send email" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_73">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="434,318" sap2010:WorkflowViewState.IdRef="TryCatch_18">
                                  <TryCatch.Try>
                                    <Sequence sap:VirtualizedContainerService.HintSize="376,179" sap2010:WorkflowViewState.IdRef="Sequence_72">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Send exception notification mail" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_60" UnSafe="False" WorkflowFileName="Global/SendEmail.xaml">
                                        <ui:InvokeWorkflowFile.Arguments>
                                          <InArgument x:TypeArguments="x:String" x:Key="in_RecipientMail">[BotSupervisorMail]</InArgument>
                                          <InArgument x:TypeArguments="x:String" x:Key="in_CC">
                                            <Literal x:TypeArguments="x:String" Value="" />
                                          </InArgument>
                                          <InArgument x:TypeArguments="x:String" x:Key="in_AttachmentPath">[GlobalErrorReportPath]</InArgument>
                                          <OutArgument x:TypeArguments="x:Boolean" x:Key="out_IsMailSent" />
                                          <InArgument x:TypeArguments="x:String" x:Key="in_MailBody">[Config("GlobalNotifcationMailBody").ToString]</InArgument>
                                          <InArgument x:TypeArguments="x:String" x:Key="in_MailSubject">[Config("GlobalNotifcationMailSubject").ToString]</InArgument>
                                        </ui:InvokeWorkflowFile.Arguments>
                                      </ui:InvokeWorkflowFile>
                                    </Sequence>
                                  </TryCatch.Try>
                                  <TryCatch.Catches>
                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,156" sap2010:WorkflowViewState.IdRef="Catch`1_19">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ActivityAction x:TypeArguments="s:Exception">
                                        <ActivityAction.Argument>
                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                        </ActivityAction.Argument>
                                        <ui:InvokeWorkflowFile ContinueOnError="True" DisplayName="Send critical alert mail" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_68" UnSafe="False" WorkflowFileName="Global/SendEmail.xaml">
                                          <ui:InvokeWorkflowFile.Arguments>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_RecipientMail">[BotSupervisorMail]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_CC">
                                              <Literal x:TypeArguments="x:String" Value="" />
                                            </InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_AttachmentPath">
                                              <Literal x:TypeArguments="x:String" Value="" />
                                            </InArgument>
                                            <OutArgument x:TypeArguments="x:Boolean" x:Key="out_IsMailSent" />
                                            <InArgument x:TypeArguments="x:String" x:Key="in_MailBody">["AP GR bot encountered critical exception." +vbNewLine + "Configuration files loading failed. Check bot logs" +vbNewLine + "Message sent by bot"]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_MailSubject">AP GR bot critical failure</InArgument>
                                          </ui:InvokeWorkflowFile.Arguments>
                                        </ui:InvokeWorkflowFile>
                                      </ActivityAction>
                                    </Catch>
                                  </TryCatch.Catches>
                                </TryCatch>
                              </Sequence>
                            </If.Then>
                          </If>
                        </Sequence>
                        <ui:InvokeWorkflowFile ContinueOnError="True" DisplayName="Send execution report mail" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_75" UnSafe="False" WorkflowFileName="Global/SendEmail.xaml">
                          <ui:InvokeWorkflowFile.Arguments>
                            <InArgument x:TypeArguments="x:String" x:Key="in_RecipientMail">[BotSupervisorMail]</InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="in_CC">
                              <Literal x:TypeArguments="x:String" Value="" />
                            </InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="in_AttachmentPath">[ExecutionReportPath]</InArgument>
                            <OutArgument x:TypeArguments="x:Boolean" x:Key="out_IsMailSent" />
                            <InArgument x:TypeArguments="x:String" x:Key="in_MailBody">[Config("ExecutionReportMailBody").ToString]</InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="in_MailSubject">[Config("ExecutionReportMailSubject").ToString]</InArgument>
                          </ui:InvokeWorkflowFile.Arguments>
                        </ui:InvokeWorkflowFile>
                      </Sequence>
                    </TryCatch.Try>
                    <TryCatch.Catches>
                      <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_5">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ActivityAction x:TypeArguments="s:Exception">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                          </ActivityAction.Argument>
                          <Sequence sap:VirtualizedContainerService.HintSize="200,83" sap2010:WorkflowViewState.IdRef="Sequence_12">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </Sequence>
                        </ActivityAction>
                      </Catch>
                    </TryCatch.Catches>
                    <TryCatch.Finally>
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_40" Level="Info" Message="[&quot;Bot execution finished&quot;]" />
                    </TryCatch.Finally>
                  </TryCatch>
                </State.Entry>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <av:Point x:Key="ShapeLocation">206.4,666.8</av:Point>
                    <av:Size x:Key="ShapeSize">167,109</av:Size>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    <x:Double x:Key="StateContainerWidth">132.86593647205055</x:Double>
                    <x:Double x:Key="StateContainerHeight">41.536135186656111</x:Double>
                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </State>
            </Transition.To>
            <Transition.Action>
              <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_23" Level="Info" Message="[&quot;Process finished due to no more entities to process&quot;]" />
            </Transition.Action>
            <Transition.Condition>
              <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="Entity Is Nothing" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_2" />
            </Transition.Condition>
          </Transition>
          <Transition DisplayName="System Error" sap:VirtualizedContainerService.HintSize="450,505" sap2010:WorkflowViewState.IdRef="Transition_10">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <av:PointCollection x:Key="ConnectorLocation">248.15,544 248.15,666.8</av:PointCollection>
                <x:Int32 x:Key="SrcConnectionPointIndex">19</x:Int32>
                <x:Int32 x:Key="DestConnectionPointIndex">18</x:Int32>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Transition.To>
              <x:Reference>__ReferenceID0</x:Reference>
            </Transition.To>
            <Transition.Action>
              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_36" Level="Fatal" Message="[&quot;Ending process execution due to unexpected error&quot;]" />
            </Transition.Action>
            <Transition.Condition>
              <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="SystemError IsNot Nothing" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_1" />
            </Transition.Condition>
          </Transition>
          <Transition DisplayName="New Transaction" sap:VirtualizedContainerService.HintSize="450,505" sap2010:WorkflowViewState.IdRef="Transition_6">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <av:PointCollection x:Key="ConnectorLocation">403.4,529.8 433.4,529.8 433.4,524.15 574,524.15</av:PointCollection>
                <x:Int32 x:Key="SrcConnectionPointIndex">68</x:Int32>
                <x:Int32 x:Key="DestConnectionPointIndex">73</x:Int32>
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Transition.Condition>
              <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="Entity IsNot Nothing" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_3" />
            </Transition.Condition>
            <Transition.To>
              <State x:Name="__ReferenceID2" sap2010:Annotation.AnnotationText="Execute process for all documents in next entity" DisplayName="Process Entity" sap:VirtualizedContainerService.HintSize="292,127" sap2010:WorkflowViewState.IdRef="State_3">
                <State.Entry>
                  <Sequence DisplayName="Process" sap:VirtualizedContainerService.HintSize="476,466" sap2010:WorkflowViewState.IdRef="Sequence_28">
                    <Sequence.Variables>
                      <Variable x:TypeArguments="x:Boolean" Name="IsEntityFailed" />
                    </Sequence.Variables>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <TryCatch DisplayName="Country process execution" sap:VirtualizedContainerService.HintSize="434,374" sap2010:WorkflowViewState.IdRef="TryCatch_7">
                      <TryCatch.Try>
                        <Sequence sap:VirtualizedContainerService.HintSize="393,306" sap2010:WorkflowViewState.IdRef="Sequence_44">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke SingleCountryProcessExecution workflow" sap:VirtualizedContainerService.HintSize="351,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_22" UnSafe="False" WorkflowFileName="Process logic\SingleCountryProcessExecution.xaml">
                            <ui:InvokeWorkflowFile.Arguments>
                              <InArgument x:TypeArguments="x:String" x:Key="in_NavisionPath">[NavPath]</InArgument>
                              <InArgument x:TypeArguments="x:String" x:Key="in_FactoryCode">[FactoryCode]</InArgument>
                              <InArgument x:TypeArguments="x:String" x:Key="in_CompanyName">[EntityName]</InArgument>
                              <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_Config">[Config]</InArgument>
                              <InArgument x:TypeArguments="sd:DataTable" x:Key="in_MailMatrix">[MailMatrix]</InArgument>
                              <InArgument x:TypeArguments="x:Boolean" x:Key="in_IsMultiCompanyNav">[IsMulticompanyNav]</InArgument>
                              <InArgument x:TypeArguments="x:Boolean" x:Key="in_IsMultifactoryCompany">[IsMultifactoryEntity]</InArgument>
                              <OutArgument x:TypeArguments="scg:Dictionary(x:String, x:Int32)" x:Key="out_Counters">[Counters]</OutArgument>
                              <OutArgument x:TypeArguments="scg:List(s:Exception)" x:Key="out_ExceptionList">[EntityExceptionList]</OutArgument>
                              <InArgument x:TypeArguments="sd:DataTable" x:Key="in_ExceptionConfig">[ExceptionConfig]</InArgument>
                              <InArgument x:TypeArguments="x:String" x:Key="in_EntityReportDirectory">[EntityReportDirectory]</InArgument>
                              <InArgument x:TypeArguments="x:String" x:Key="in_EntitySupervisorMail">[EntitySupervisorMail]</InArgument>
                              <InArgument x:TypeArguments="x:String" x:Key="in_GlobalExecutionReportPath">[ExecutionReportPath]</InArgument>
                              <InArgument x:TypeArguments="x:String" x:Key="in_GlobalExceptionReportPath">[GlobalErrorReportPath]</InArgument>
                              <OutArgument x:TypeArguments="x:Boolean" x:Key="out_EntityFailed">[IsEntityFailed]</OutArgument>
                            </ui:InvokeWorkflowFile.Arguments>
                          </ui:InvokeWorkflowFile>
                          <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke PushExceptionBufferToList workflow" sap:VirtualizedContainerService.HintSize="351,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_48" UnSafe="False" WorkflowFileName="ErrorHandling\PushExceptionBufferToList.xaml">
                            <ui:InvokeWorkflowFile.Arguments>
                              <InOutArgument x:TypeArguments="scg:List(s:Exception)" x:Key="io_ExceptionBuffer">[EntityExceptionList]</InOutArgument>
                              <InOutArgument x:TypeArguments="scg:List(s:Exception)" x:Key="io_ExceptionList">[GlobalExceptionList]</InOutArgument>
                            </ui:InvokeWorkflowFile.Arguments>
                          </ui:InvokeWorkflowFile>
                        </Sequence>
                      </TryCatch.Try>
                      <TryCatch.Catches>
                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,212" sap2010:WorkflowViewState.IdRef="Catch`1_8">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ActivityAction x:TypeArguments="s:Exception">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                            </ActivityAction.Argument>
                            <Sequence sap:VirtualizedContainerService.HintSize="242,143" sap2010:WorkflowViewState.IdRef="Sequence_49">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="607,435" sap2010:WorkflowViewState.IdRef="TryCatch_12">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <TryCatch.Try>
                                  <Sequence sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_50">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Assign sap:VirtualizedContainerService.HintSize="340,60" sap2010:WorkflowViewState.IdRef="Assign_55">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:Boolean">[IsEntityFailed]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="New 000 - unexpected error" sap:VirtualizedContainerService.HintSize="340,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_38" UnSafe="False" WorkflowFileName="ErrorHandling/NewExceptionWithCode.xaml">
                                      <ui:InvokeWorkflowFile.Arguments>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_Message">Encountered unexpected exception while processing entity</InArgument>
                                        <OutArgument x:TypeArguments="s:Exception" x:Key="out_Exception">[SystemError]</OutArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_Code">000</InArgument>
                                      </ui:InvokeWorkflowFile.Arguments>
                                    </ui:InvokeWorkflowFile>
                                    <AddToCollection x:TypeArguments="s:Exception" Collection="[ExceptionBuffer]" DisplayName="Add To Collection" sap:VirtualizedContainerService.HintSize="340,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_2" Item="[SystemError]" />
                                    <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="New 200 - Entity processing failed" sap:VirtualizedContainerService.HintSize="340,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_39" UnSafe="False" WorkflowFileName="ErrorHandling\NewExceptionAndAddToList.xaml">
                                      <ui:InvokeWorkflowFile.Arguments>
                                        <InOutArgument x:TypeArguments="scg:List(s:Exception)" x:Key="io_ExceptionBuffer">[ExceptionBuffer]</InOutArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_Message">Entity processing failed</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_Code">200</InArgument>
                                      </ui:InvokeWorkflowFile.Arguments>
                                    </ui:InvokeWorkflowFile>
                                  </Sequence>
                                </TryCatch.Try>
                                <TryCatch.Catches>
                                  <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="573,21" sap2010:WorkflowViewState.IdRef="Catch`1_13">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ActivityAction x:TypeArguments="s:Exception">
                                      <ActivityAction.Argument>
                                        <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                      </ActivityAction.Argument>
                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_39" Level="Fatal" Message="[&quot;Unexpected error processing failed&quot;]" />
                                    </ActivityAction>
                                  </Catch>
                                </TryCatch.Catches>
                                <TryCatch.Finally>
                                  <If Condition="[IsEntityFailed]" sap:VirtualizedContainerService.HintSize="569,208" sap2010:WorkflowViewState.IdRef="If_15">
                                    <If.Then>
                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_56">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Int32">[FailedEntitiesCounter]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Int32">[FailedEntitiesCounter+1]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                    </If.Then>
                                    <If.Else>
                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_57">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Int32">[FailedEntitiesCounter]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                    </If.Else>
                                  </If>
                                </TryCatch.Finally>
                              </TryCatch>
                            </Sequence>
                          </ActivityAction>
                        </Catch>
                      </TryCatch.Catches>
                    </TryCatch>
                  </Sequence>
                </State.Entry>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <av:Point x:Key="ShapeLocation">574,403.5</av:Point>
                    <av:Size x:Key="ShapeSize">292,127</av:Size>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    <x:Double x:Key="StateContainerWidth">258.43823544496513</x:Double>
                    <x:Double x:Key="StateContainerHeight">59.753615264799464</x:Double>
                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <State.Exit>
                  <Sequence sap:VirtualizedContainerService.HintSize="376,279" sap2010:WorkflowViewState.IdRef="Sequence_54">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:InvokeWorkflowFile ContinueOnError="True" DisplayName="Invoke ReportExceptions_Single workflow" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_44" UnSafe="False" WorkflowFileName="ErrorHandling/ReportExceptions_Global.xaml">
                      <ui:InvokeWorkflowFile.Arguments>
                        <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_Config">[Config]</InArgument>
                        <InArgument x:TypeArguments="sd:DataTable" x:Key="in_ExceptionConfig">[ExceptionConfig]</InArgument>
                        <InOutArgument x:TypeArguments="scg:List(s:Exception)" x:Key="io_ExceptionList">[GlobalExceptionList]</InOutArgument>
                        <InOutArgument x:TypeArguments="scg:List(s:Exception)" x:Key="io_ExceptionBuffer">[ExceptionBuffer]</InOutArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_FactoryCode">[FactoryCode]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_DocumentNo">-</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_ReportPath">[GlobalErrorReportPath]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_CompanyName">[EntityName]</InArgument>
                      </ui:InvokeWorkflowFile.Arguments>
                    </ui:InvokeWorkflowFile>
                    <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_35">
                      <Assign.To>
                        <OutArgument x:TypeArguments="x:Int32">[EntityNumber]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="x:Int32">[EntityNumber+1]</InArgument>
                      </Assign.Value>
                    </Assign>
                  </Sequence>
                </State.Exit>
                <State.Transitions>
                  <Transition DisplayName="Error" sap:VirtualizedContainerService.HintSize="450,505" sap2010:WorkflowViewState.IdRef="Transition_4">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <av:PointCollection x:Key="ConnectorLocation">574,428.9 544,428.9 544,430.4 403.4,430.4</av:PointCollection>
                        <x:Int32 x:Key="SrcConnectionPointIndex">13</x:Int32>
                        <x:Int32 x:Key="DestConnectionPointIndex">12</x:Int32>
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Transition.To>
                      <x:Reference>__ReferenceID1</x:Reference>
                    </Transition.To>
                    <Transition.Condition>
                      <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="SystemError IsNot Nothing" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_4" />
                    </Transition.Condition>
                  </Transition>
                  <Transition sap2010:Annotation.AnnotationText="No need for any action here, in case of success simply go to next transaction" DisplayName="Success" sap:VirtualizedContainerService.HintSize="450,532" sap2010:WorkflowViewState.IdRef="Transition_5">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <av:PointCollection x:Key="ConnectorLocation">574,467 544,467 544,480.1 403.4,480.1</av:PointCollection>
                        <x:Int32 x:Key="SrcConnectionPointIndex">37</x:Int32>
                        <x:Int32 x:Key="DestConnectionPointIndex">40</x:Int32>
                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Transition.To>
                      <x:Reference>__ReferenceID1</x:Reference>
                    </Transition.To>
                    <Transition.Condition>
                      <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="SystemError Is Nothing" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_5" />
                    </Transition.Condition>
                  </Transition>
                </State.Transitions>
              </State>
            </Transition.To>
          </Transition>
        </State.Transitions>
      </State>
      <x:Reference>__ReferenceID2</x:Reference>
      <x:Reference>__ReferenceID0</x:Reference>
      <State x:Name="__ReferenceID3" sap2010:Annotation.AnnotationText="Load configuration files and environment variables" DisplayName="Init" sap:VirtualizedContainerService.HintSize="234,103" sap2010:WorkflowViewState.IdRef="State_5">
        <State.Entry>
          <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="438,1405" sap2010:WorkflowViewState.IdRef="TryCatch_6">
            <TryCatch.Try>
              <Sequence sap:VirtualizedContainerService.HintSize="399,1178" sap2010:WorkflowViewState.IdRef="Sequence_26">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <Assign sap:VirtualizedContainerService.HintSize="357,60" sap2010:WorkflowViewState.IdRef="Assign_41">
                  <Assign.To>
                    <OutArgument x:TypeArguments="scg:List(s:Exception)">[GlobalExceptionList]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="scg:List(s:Exception)">[New List(of Exception)]</InArgument>
                  </Assign.Value>
                </Assign>
                <Assign sap:VirtualizedContainerService.HintSize="357,60" sap2010:WorkflowViewState.IdRef="Assign_39">
                  <Assign.To>
                    <OutArgument x:TypeArguments="scg:List(s:Exception)">[ExceptionBuffer]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="scg:List(s:Exception)">[New List(of Exception)]</InArgument>
                  </Assign.Value>
                </Assign>
                <Assign sap:VirtualizedContainerService.HintSize="357,60" sap2010:WorkflowViewState.IdRef="Assign_34">
                  <Assign.To>
                    <OutArgument x:TypeArguments="s:Exception">[SystemError]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="s:Exception">[Nothing]</InArgument>
                  </Assign.Value>
                </Assign>
                <Assign sap:VirtualizedContainerService.HintSize="357,60" sap2010:WorkflowViewState.IdRef="Assign_30">
                  <Assign.To>
                    <OutArgument x:TypeArguments="s:DateTime">[StartTime]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="s:DateTime">[Now]</InArgument>
                  </Assign.Value>
                </Assign>
                <TryCatch DisplayName="Private: Get supervisor mail" sap:VirtualizedContainerService.HintSize="357,51" sap2010:WorkflowViewState.IdRef="TryCatch_19">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <TryCatch.Try>
                    <Sequence sap:VirtualizedContainerService.HintSize="376,279" sap2010:WorkflowViewState.IdRef="Sequence_75">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Get supervisor mail environment variable" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_62" UnSafe="False" WorkflowFileName="Global/GetEnvironmentVariable.xaml">
                        <ui:InvokeWorkflowFile.Arguments>
                          <InOutArgument x:TypeArguments="x:String" x:Key="io_EnvironmentVariableValue">[BotSupervisorMail]</InOutArgument>
                          <InArgument x:TypeArguments="x:String" x:Key="in_EnvironmentVariableName">BOT_AP_GR_mail</InArgument>
                        </ui:InvokeWorkflowFile.Arguments>
                      </ui:InvokeWorkflowFile>
                      <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_53">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:Boolean">[IsSupervisorMailSet]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                        </Assign.Value>
                      </Assign>
                    </Sequence>
                  </TryCatch.Try>
                  <TryCatch.Catches>
                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_20">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ActivityAction x:TypeArguments="s:Exception">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                        </ActivityAction.Argument>
                        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="New 906 missing e-mail setup" sap:VirtualizedContainerService.HintSize="340,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_69" UnSafe="False" WorkflowFileName="ErrorHandling\NewExceptionAndAddToList.xaml">
                          <ui:InvokeWorkflowFile.Arguments>
                            <InOutArgument x:TypeArguments="scg:List(s:Exception)" x:Key="io_ExceptionBuffer">[ExceptionBuffer]</InOutArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="in_Message">Missing BOT_AP_GR_mail environment variable</InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="in_Code">906</InArgument>
                          </ui:InvokeWorkflowFile.Arguments>
                        </ui:InvokeWorkflowFile>
                      </ActivityAction>
                    </Catch>
                  </TryCatch.Catches>
                </TryCatch>
                <TryCatch DisplayName="Get Config path environment variable" sap:VirtualizedContainerService.HintSize="438,314" sap2010:WorkflowViewState.IdRef="TryCatch_20">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <TryCatch.Try>
                    <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Get Config path environment variable" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_29" UnSafe="False" WorkflowFileName="Global/GetEnvironmentVariable.xaml">
                      <ui:InvokeWorkflowFile.Arguments>
                        <InOutArgument x:TypeArguments="x:String" x:Key="io_EnvironmentVariableValue">[ConfigPath]</InOutArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_EnvironmentVariableName">BOT_AP_GR_config_path</InArgument>
                      </ui:InvokeWorkflowFile.Arguments>
                    </ui:InvokeWorkflowFile>
                  </TryCatch.Try>
                  <TryCatch.Catches>
                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_21">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ActivityAction x:TypeArguments="s:Exception">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                        </ActivityAction.Argument>
                        <Sequence sap:VirtualizedContainerService.HintSize="376,243" sap2010:WorkflowViewState.IdRef="Sequence_74">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="New 105" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_70" UnSafe="False" WorkflowFileName="ErrorHandling\NewExceptionWithCode.xaml">
                            <ui:InvokeWorkflowFile.Arguments>
                              <InArgument x:TypeArguments="x:String" x:Key="in_Message">Missing environment variable: BOT_AP_GR_ConfigPath</InArgument>
                              <OutArgument x:TypeArguments="s:Exception" x:Key="out_Exception">[SystemError]</OutArgument>
                              <InArgument x:TypeArguments="x:String" x:Key="in_Code">105</InArgument>
                            </ui:InvokeWorkflowFile.Arguments>
                          </ui:InvokeWorkflowFile>
                          <Throw Exception="[SystemError]" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Throw_12" />
                        </Sequence>
                      </ActivityAction>
                    </Catch>
                  </TryCatch.Catches>
                </TryCatch>
                <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke KillAllProcesses workflow" sap:VirtualizedContainerService.HintSize="357,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_19" UnSafe="False" WorkflowFileName="Global\KillAllProcesses.xaml">
                  <ui:InvokeWorkflowFile.Arguments>
                    <scg:Dictionary x:TypeArguments="x:String, Argument" />
                  </ui:InvokeWorkflowFile.Arguments>
                </ui:InvokeWorkflowFile>
                <Sequence DisplayName="Load input files" sap:VirtualizedContainerService.HintSize="357,66" sap2010:WorkflowViewState.IdRef="Sequence_29">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <TryCatch DisplayName="Load Config file data" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="TryCatch_9">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <TryCatch.Try>
                      <Sequence sap:VirtualizedContainerService.HintSize="731,619" sap2010:WorkflowViewState.IdRef="Sequence_43">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Load Config Data" sap:VirtualizedContainerService.HintSize="689,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_16" UnSafe="False" WorkflowFileName="Global/LoadConfigFile.xaml">
                          <ui:InvokeWorkflowFile.Arguments>
                            <OutArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="out_Config">[Config]</OutArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="in_ConfigFilePath">[ConfigPath]</InArgument>
                          </ui:InvokeWorkflowFile.Arguments>
                        </ui:InvokeWorkflowFile>
                        <If Condition="[NOT String.IsNullOrEmpty(Config(&quot;SupervisorMail&quot;).ToString)]" sap:VirtualizedContainerService.HintSize="689,400" sap2010:WorkflowViewState.IdRef="If_13">
                          <If.Then>
                            <Sequence sap:VirtualizedContainerService.HintSize="304,252" sap2010:WorkflowViewState.IdRef="Sequence_76">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_52">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[BotSupervisorMail]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">[Config("SupervisorMail").ToString]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_54">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:Boolean">[IsSupervisorMailSet]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                </Assign.Value>
                              </Assign>
                            </Sequence>
                          </If.Then>
                          <If.Else>
                            <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke NewExceptionAndAddToList workflow" sap:VirtualizedContainerService.HintSize="340,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_73" UnSafe="False" WorkflowFileName="ErrorHandling\NewExceptionAndAddToList.xaml">
                              <ui:InvokeWorkflowFile.Arguments>
                                <InOutArgument x:TypeArguments="scg:List(s:Exception)" x:Key="io_ExceptionBuffer">[ExceptionBuffer]</InOutArgument>
                                <InArgument x:TypeArguments="x:String" x:Key="in_Message">Supervisor mail not set in config file</InArgument>
                                <InArgument x:TypeArguments="x:String" x:Key="in_Code">907</InArgument>
                              </ui:InvokeWorkflowFile.Arguments>
                            </ui:InvokeWorkflowFile>
                          </If.Else>
                        </If>
                      </Sequence>
                    </TryCatch.Try>
                    <TryCatch.Catches>
                      <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="735,21" sap2010:WorkflowViewState.IdRef="Catch`1_10">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ActivityAction x:TypeArguments="s:Exception">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                          </ActivityAction.Argument>
                          <Sequence sap:VirtualizedContainerService.HintSize="376,468" sap2010:WorkflowViewState.IdRef="Sequence_62">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_44">
                              <Assign.To>
                                <OutArgument x:TypeArguments="x:Boolean">[SendCriticalExceptionMail]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                              </Assign.Value>
                            </Assign>
                            <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="New 100 - config data error" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_32" UnSafe="False" WorkflowFileName="ErrorHandling/NewExceptionWithCode.xaml">
                              <ui:InvokeWorkflowFile.Arguments>
                                <InArgument x:TypeArguments="x:String" x:Key="in_Message">[exception.Message]</InArgument>
                                <OutArgument x:TypeArguments="s:Exception" x:Key="out_Exception">[SystemError]</OutArgument>
                                <InArgument x:TypeArguments="x:String" x:Key="in_Code">100</InArgument>
                              </ui:InvokeWorkflowFile.Arguments>
                            </ui:InvokeWorkflowFile>
                            <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Set Notify global supervisor flag TRUE" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_58" UnSafe="False" WorkflowFileName="ErrorHandling\SetFlagIfNull.xaml">
                              <ui:InvokeWorkflowFile.Arguments>
                                <InArgument x:TypeArguments="x:String" x:Key="in_FlagValue">NotifyGlobalSupervisor</InArgument>
                                <InOutArgument x:TypeArguments="s:Exception" x:Key="io_SystemError">[SystemError]</InOutArgument>
                                <InArgument x:TypeArguments="x:String" x:Key="in_Flag">TRUE</InArgument>
                              </ui:InvokeWorkflowFile.Arguments>
                            </ui:InvokeWorkflowFile>
                            <Throw Exception="[SystemError]" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Throw_6" />
                          </Sequence>
                        </ActivityAction>
                      </Catch>
                    </TryCatch.Catches>
                  </TryCatch>
                  <Sequence DisplayName="Set reports paths" sap:VirtualizedContainerService.HintSize="334,66" sap2010:WorkflowViewState.IdRef="Sequence_70">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <TryCatch DisplayName="Set GlobalExceptionReportPath" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_16">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <TryCatch.Try>
                        <Sequence sap:VirtualizedContainerService.HintSize="549,300" sap2010:WorkflowViewState.IdRef="Sequence_66">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <If Condition="[String.IsNullOrEmpty(Config(&quot;GlobalErrorReportDirectory&quot;).ToString)]" sap:VirtualizedContainerService.HintSize="507,208" sap2010:WorkflowViewState.IdRef="If_12">
                            <If.Then>
                              <Throw Exception="[New Exception(&quot;Empty config field: Global error report directory&quot;)]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_11" />
                            </If.Then>
                            <If.Else>
                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_49">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[GlobalErrorReportPath]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String" xml:space="preserve">[Config("GlobalErrorReportDirectory").ToString + "Global Error Report "+StartTime.ToShortDateString.Replace("/","-").Replace(":","-") + "   " + StartTime.ToShortTimeString.Replace(":","-") + ".xlsx"]</InArgument>
                                </Assign.Value>
                              </Assign>
                            </If.Else>
                          </If>
                        </Sequence>
                      </TryCatch.Try>
                      <TryCatch.Catches>
                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,310" sap2010:WorkflowViewState.IdRef="Catch`1_17">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ActivityAction x:TypeArguments="s:Exception">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                            </ActivityAction.Argument>
                            <Sequence sap:VirtualizedContainerService.HintSize="376,241" sap2010:WorkflowViewState.IdRef="Sequence_67">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="New 103 - missing GlobalExceptionReportDirectory" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_63" UnSafe="False" WorkflowFileName="ErrorHandling\NewExceptionWithCode.xaml">
                                <ui:InvokeWorkflowFile.Arguments>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_Message">Missing Config field - GlobalExceptionReportDirectory</InArgument>
                                  <OutArgument x:TypeArguments="s:Exception" x:Key="out_Exception">[SystemError]</OutArgument>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_Code">103</InArgument>
                                </ui:InvokeWorkflowFile.Arguments>
                              </ui:InvokeWorkflowFile>
                              <AddToCollection x:TypeArguments="s:Exception" Collection="[ExceptionBuffer]" DisplayName="Add To Collection" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_4" Item="[SystemError]" />
                            </Sequence>
                          </ActivityAction>
                        </Catch>
                      </TryCatch.Catches>
                    </TryCatch>
                    <TryCatch DisplayName="Set ExecutionReportPath" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_17">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <TryCatch.Try>
                        <Sequence sap:VirtualizedContainerService.HintSize="689,327" sap2010:WorkflowViewState.IdRef="Sequence_68">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <If Condition="[String.IsNullOrEmpty(Config(&quot;ExecutionReportDirectory&quot;).ToString)]" sap:VirtualizedContainerService.HintSize="647,235" sap2010:WorkflowViewState.IdRef="If_11">
                            <If.Then>
                              <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="New 103 - missing ExecutionReportDirectory" sap:VirtualizedContainerService.HintSize="340,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_65" UnSafe="False" WorkflowFileName="ErrorHandling\NewExceptionAndAddToList.xaml">
                                <ui:InvokeWorkflowFile.Arguments>
                                  <InOutArgument x:TypeArguments="scg:List(s:Exception)" x:Key="io_ExceptionBuffer">[ExceptionBuffer]</InOutArgument>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_Message">Missing Config field - ExecutionReportDirectory</InArgument>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_Code">103</InArgument>
                                </ui:InvokeWorkflowFile.Arguments>
                              </ui:InvokeWorkflowFile>
                            </If.Then>
                            <If.Else>
                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_48">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[ExecutionReportPath]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String" xml:space="preserve">[Config("ExecutionReportDirectory").ToString + "Bot execution report "+StartTime.ToShortDateString.Replace(":","-").Replace("/","-") + "   " + StartTime.ToShortTimeString.Replace(":","-") + ".xlsx"]</InArgument>
                                </Assign.Value>
                              </Assign>
                            </If.Else>
                          </If>
                        </Sequence>
                      </TryCatch.Try>
                      <TryCatch.Catches>
                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="693,21" sap2010:WorkflowViewState.IdRef="Catch`1_18">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ActivityAction x:TypeArguments="s:Exception">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                            </ActivityAction.Argument>
                            <Sequence sap:VirtualizedContainerService.HintSize="382,179" sap2010:WorkflowViewState.IdRef="Sequence_69">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="New 103 - missing ExecutionReportDirectory" sap:VirtualizedContainerService.HintSize="340,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_64" UnSafe="False" WorkflowFileName="ErrorHandling\NewExceptionAndAddToList.xaml">
                                <ui:InvokeWorkflowFile.Arguments>
                                  <InOutArgument x:TypeArguments="scg:List(s:Exception)" x:Key="io_ExceptionBuffer">[ExceptionBuffer]</InOutArgument>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_Message">Missing Config field - ExecutionReportDirectory</InArgument>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_Code">103</InArgument>
                                </ui:InvokeWorkflowFile.Arguments>
                              </ui:InvokeWorkflowFile>
                            </Sequence>
                          </ActivityAction>
                        </Catch>
                      </TryCatch.Catches>
                    </TryCatch>
                  </Sequence>
                  <TryCatch DisplayName="Load Exception config data" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="TryCatch_15">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <TryCatch.Try>
                      <Sequence sap:VirtualizedContainerService.HintSize="376,179" sap2010:WorkflowViewState.IdRef="Sequence_61">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:ReadRange Range="{x:Null}" AddHeaders="True" DataTable="[ExceptionConfig]" DisplayName="Load exception config data" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ReadRange_6" SheetName="[Config(&quot;ErrorConfigSheetName&quot;).ToString]" WorkbookPath="[ConfigPath]" />
                      </Sequence>
                    </TryCatch.Try>
                    <TryCatch.Catches>
                      <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_16">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ActivityAction x:TypeArguments="s:Exception">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                          </ActivityAction.Argument>
                          <Sequence sap:VirtualizedContainerService.HintSize="376,469" sap2010:WorkflowViewState.IdRef="Sequence_64">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="New 106 - exception config loading error" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_57" UnSafe="False" WorkflowFileName="ErrorHandling/NewExceptionWithCode.xaml">
                              <ui:InvokeWorkflowFile.Arguments>
                                <InArgument x:TypeArguments="x:String" x:Key="in_Message">[exception.Message]</InArgument>
                                <OutArgument x:TypeArguments="s:Exception" x:Key="out_Exception">[SystemError]</OutArgument>
                                <InArgument x:TypeArguments="x:String" x:Key="in_Code">106</InArgument>
                              </ui:InvokeWorkflowFile.Arguments>
                            </ui:InvokeWorkflowFile>
                            <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Set Notify global supervisor flag TRUE" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_59" UnSafe="False" WorkflowFileName="ErrorHandling\SetFlagIfNull.xaml">
                              <ui:InvokeWorkflowFile.Arguments>
                                <InArgument x:TypeArguments="x:String" x:Key="in_FlagValue">NotifyGlobalSupervisor</InArgument>
                                <InOutArgument x:TypeArguments="s:Exception" x:Key="io_SystemError">[SystemError]</InOutArgument>
                                <InArgument x:TypeArguments="x:String" x:Key="in_Flag">TRUE</InArgument>
                              </ui:InvokeWorkflowFile.Arguments>
                            </ui:InvokeWorkflowFile>
                            <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_45">
                              <Assign.To>
                                <OutArgument x:TypeArguments="x:Boolean">[SendCriticalExceptionMail]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                              </Assign.Value>
                            </Assign>
                            <Throw Exception="[SystemError]" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Throw_8" />
                          </Sequence>
                        </ActivityAction>
                      </Catch>
                    </TryCatch.Catches>
                  </TryCatch>
                  <TryCatch DisplayName="Load Companies data" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="TryCatch_14">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <TryCatch.Try>
                      <ui:ReadRange Range="{x:Null}" AddHeaders="True" DataTable="[EntitiesData]" DisplayName="Load companies login data" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ReadRange_4" SheetName="[Config(&quot;CompaniesLoginDataSheetName&quot;).ToString]" WorkbookPath="[ConfigPath]" />
                    </TryCatch.Try>
                    <TryCatch.Catches>
                      <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_15">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ActivityAction x:TypeArguments="s:Exception">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                          </ActivityAction.Argument>
                          <Sequence sap:VirtualizedContainerService.HintSize="376,243" sap2010:WorkflowViewState.IdRef="Sequence_63">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="New 102 - loading companies data exception" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_55" UnSafe="False" WorkflowFileName="ErrorHandling/NewExceptionWithCode.xaml">
                              <ui:InvokeWorkflowFile.Arguments>
                                <InArgument x:TypeArguments="x:String" x:Key="in_Message">[exception.Message]</InArgument>
                                <OutArgument x:TypeArguments="s:Exception" x:Key="out_Exception">[SystemError]</OutArgument>
                                <InArgument x:TypeArguments="x:String" x:Key="in_Code">102</InArgument>
                              </ui:InvokeWorkflowFile.Arguments>
                            </ui:InvokeWorkflowFile>
                            <Throw Exception="[SystemError]" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Throw_7" />
                          </Sequence>
                        </ActivityAction>
                      </Catch>
                    </TryCatch.Catches>
                  </TryCatch>
                  <TryCatch DisplayName="Load mail matrix" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="TryCatch_13">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <TryCatch.Try>
                      <ui:ReadRange AddHeaders="True" DataTable="[MailMatrix]" DisplayName="Read mail matrix" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ReadRange_3" Range="A4" SheetName="[Config(&quot;MailDecisionMatrixSheetName&quot;).ToString]" WorkbookPath="[Config(&quot;MailDecisionMatrixPath&quot;).ToString]">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:ReadRange>
                    </TryCatch.Try>
                    <TryCatch.Catches>
                      <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_14">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ActivityAction x:TypeArguments="s:Exception">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                          </ActivityAction.Argument>
                          <Sequence sap:VirtualizedContainerService.HintSize="379,181" sap2010:WorkflowViewState.IdRef="Sequence_51">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="New 101 - missing cc mail matrix" sap:VirtualizedContainerService.HintSize="340,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_50" UnSafe="False" WorkflowFileName="ErrorHandling\NewExceptionAndAddToList.xaml">
                              <ui:InvokeWorkflowFile.Arguments>
                                <InOutArgument x:TypeArguments="scg:List(s:Exception)" x:Key="io_ExceptionBuffer">[ExceptionBuffer]</InOutArgument>
                                <InArgument x:TypeArguments="x:String" x:Key="in_Message">Mail decision matrix loading failed</InArgument>
                                <InArgument x:TypeArguments="x:String" x:Key="in_Code">101</InArgument>
                              </ui:InvokeWorkflowFile.Arguments>
                            </ui:InvokeWorkflowFile>
                          </Sequence>
                        </ActivityAction>
                      </Catch>
                    </TryCatch.Catches>
                  </TryCatch>
                  <ui:LogMessage DisplayName="Log Loading Config File " sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_38" Level="Info" Message="[&quot;Loading input files finished&quot;]" />
                </Sequence>
                <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Check if report templates are defined" sap:VirtualizedContainerService.HintSize="357,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_47" UnSafe="False" WorkflowFileName="Process logic\CheckDocumentTemplatesPaths.xaml">
                  <ui:InvokeWorkflowFile.Arguments>
                    <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_Config">[Config]</InArgument>
                    <InOutArgument x:TypeArguments="scg:List(s:Exception)" x:Key="io_ExceptionList">[ExceptionBuffer]</InOutArgument>
                  </ui:InvokeWorkflowFile.Arguments>
                </ui:InvokeWorkflowFile>
                <ui:AddLogFields sap2010:Annotation.AnnotationText="Add BusinessProcessName" DisplayName="Add Log Fields" sap:VirtualizedContainerService.HintSize="357,53" sap2010:WorkflowViewState.IdRef="AddLogFields_1">
                  <ui:AddLogFields.Fields>
                    <InArgument x:TypeArguments="x:String" x:Key="logF_BusinessProcessName">[Config("logF_BusinessProcessName").ToString]</InArgument>
                  </ui:AddLogFields.Fields>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:AddLogFields>
                <If Condition="[Not IsSupervisorMailSet]" DisplayName="Set error if supervisor mail not set" sap:VirtualizedContainerService.HintSize="357,51" sap2010:WorkflowViewState.IdRef="If_14">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <If.Then>
                    <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="New 908 - supervisor mail not set" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_72" UnSafe="False" WorkflowFileName="ErrorHandling\NewExceptionWithCode.xaml">
                      <ui:InvokeWorkflowFile.Arguments>
                        <InArgument x:TypeArguments="x:String" x:Key="in_Message">Bor supervisor mail not set correctly</InArgument>
                        <OutArgument x:TypeArguments="s:Exception" x:Key="out_Exception">[SystemError]</OutArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_Code">908</InArgument>
                      </ui:InvokeWorkflowFile.Arguments>
                    </ui:InvokeWorkflowFile>
                  </If.Then>
                </If>
              </Sequence>
            </TryCatch.Try>
            <TryCatch.Catches>
              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_7">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ActivityAction x:TypeArguments="s:Exception">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                  </ActivityAction.Argument>
                  <Sequence sap:VirtualizedContainerService.HintSize="376,340" sap2010:WorkflowViewState.IdRef="Sequence_53">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_31">
                      <Assign.To>
                        <OutArgument x:TypeArguments="s:Exception">[SystemError]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="s:Exception">[exception]</InArgument>
                      </Assign.Value>
                    </Assign>
                    <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Set default 000 " sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_41" UnSafe="False" WorkflowFileName="ErrorHandling\SetFlagIfNull.xaml">
                      <ui:InvokeWorkflowFile.Arguments>
                        <InArgument x:TypeArguments="x:String" x:Key="in_FlagValue">000</InArgument>
                        <InOutArgument x:TypeArguments="s:Exception" x:Key="io_SystemError">[SystemError]</InOutArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_Flag">Code</InArgument>
                      </ui:InvokeWorkflowFile.Arguments>
                    </ui:InvokeWorkflowFile>
                    <AddToCollection x:TypeArguments="s:Exception" Collection="[ExceptionBuffer]" DisplayName="Add To Collection" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_3" Item="[SystemError]" />
                  </Sequence>
                </ActivityAction>
              </Catch>
            </TryCatch.Catches>
          </TryCatch>
        </State.Entry>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">192.8,135.2</av:Point>
            <av:Size x:Key="ShapeSize">234,103</av:Size>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
            <x:Double x:Key="StateContainerWidth">200.00000000000009</x:Double>
            <x:Double x:Key="StateContainerHeight">25</x:Double>
            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <State.Transitions>
          <Transition DisplayName="START" sap:VirtualizedContainerService.HintSize="450,505" sap2010:WorkflowViewState.IdRef="Transition_8">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Int32 x:Key="SrcConnectionPointIndex">35</x:Int32>
                <x:Int32 x:Key="DestConnectionPointIndex">38</x:Int32>
                <av:PointCollection x:Key="ConnectorLocation">298.1,238.2 298.1,268.2 299.9,268.2 299.9,402</av:PointCollection>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Transition.To>
              <x:Reference>__ReferenceID1</x:Reference>
            </Transition.To>
            <Transition.Action>
              <ui:InvokeWorkflowFile ContinueOnError="True" DisplayName="Invoke ReportExceptions_Global workflow" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_67" UnSafe="False" WorkflowFileName="ErrorHandling/ReportExceptions_Global.xaml">
                <ui:InvokeWorkflowFile.Arguments>
                  <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_Config">[Config]</InArgument>
                  <InArgument x:TypeArguments="sd:DataTable" x:Key="in_ExceptionConfig">[ExceptionConfig]</InArgument>
                  <InOutArgument x:TypeArguments="scg:List(s:Exception)" x:Key="io_ExceptionList">[GlobalExceptionList]</InOutArgument>
                  <InOutArgument x:TypeArguments="scg:List(s:Exception)" x:Key="io_ExceptionBuffer">[ExceptionBuffer]</InOutArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="in_FactoryCode">[FactoryCode]</InArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="in_DocumentNo">-</InArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="in_ReportPath">[GlobalErrorReportPath]</InArgument>
                  <InArgument x:TypeArguments="x:String" x:Key="in_CompanyName">
                    <Literal x:TypeArguments="x:String" Value="" />
                  </InArgument>
                </ui:InvokeWorkflowFile.Arguments>
              </ui:InvokeWorkflowFile>
            </Transition.Action>
            <Transition.Condition>
              <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="SystemError is nothing" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_1" />
            </Transition.Condition>
          </Transition>
          <Transition DisplayName="System Error" sap:VirtualizedContainerService.HintSize="450,505" sap2010:WorkflowViewState.IdRef="Transition_9">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <av:PointCollection x:Key="ConnectorLocation">192.8,191.85 118,191.85 118,631.04 223.1,631.04 223.1,666.8</av:PointCollection>
                <x:Int32 x:Key="SrcConnectionPointIndex">41</x:Int32>
                <x:Int32 x:Key="DestConnectionPointIndex">6</x:Int32>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Transition.To>
              <x:Reference>__ReferenceID0</x:Reference>
            </Transition.To>
            <Transition.Action>
              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_51">
                <Assign.To>
                  <OutArgument x:TypeArguments="x:Boolean">[SendCriticalExceptionMail]</OutArgument>
                </Assign.To>
                <Assign.Value>
                  <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                </Assign.Value>
              </Assign>
            </Transition.Action>
            <Transition.Condition>[SystemError IsNot Nothing]</Transition.Condition>
          </Transition>
        </State.Transitions>
        <State.Variables>
          <Variable x:TypeArguments="x:Boolean" Name="IsSupervisorMailSet" />
        </State.Variables>
      </State>
      <StateMachine.Variables>
        <Variable x:TypeArguments="sd:DataRow" Name="Entity" />
        <Variable x:TypeArguments="s:Exception" Name="SystemError" />
        <Variable x:TypeArguments="x:Int32" Default="0" Name="EntityNumber" />
        <Variable x:TypeArguments="scg:Dictionary(x:String, x:Object)" Name="Config" />
        <Variable x:TypeArguments="sd:DataTable" Name="EntitiesData" />
        <Variable x:TypeArguments="sd:DataTable" Name="MailMatrix" />
        <Variable x:TypeArguments="x:String" Name="EntityName" />
        <Variable x:TypeArguments="x:String" Name="FactoryCode" />
        <Variable x:TypeArguments="x:String" Name="NavPath" />
        <Variable x:TypeArguments="x:Boolean" Name="IsMulticompanyNav" />
        <Variable x:TypeArguments="x:Boolean" Name="IsMultifactoryEntity" />
        <Variable x:TypeArguments="x:String" Default="itservicedesk.global@oerlikon.com" Name="BotSupervisorMail" />
        <Variable x:TypeArguments="x:String" Name="ConfigPath" />
        <Variable x:TypeArguments="scg:Dictionary(x:String, x:Int32)" Name="Counters" />
        <Variable x:TypeArguments="s:DateTime" Name="StartTime" />
        <Variable x:TypeArguments="scg:List(s:Exception)" Name="GlobalExceptionList" />
        <Variable x:TypeArguments="sd:DataTable" Name="ExceptionConfig" />
        <Variable x:TypeArguments="scg:List(s:Exception)" Name="EntityExceptionList" />
        <Variable x:TypeArguments="x:String" Name="EntitySupervisorMail" />
        <Variable x:TypeArguments="x:String" Name="EntityReportDirectory" />
        <Variable x:TypeArguments="x:String" Name="GlobalErrorReportPath" />
        <Variable x:TypeArguments="x:String" Name="ExecutionReportPath" />
        <Variable x:TypeArguments="scg:List(s:Exception)" Name="ExceptionBuffer" />
        <Variable x:TypeArguments="x:Boolean" Default="False" Name="SendCriticalExceptionMail" />
        <Variable x:TypeArguments="x:Int32" Default="0" Name="FailedEntitiesCounter" />
      </StateMachine.Variables>
    </StateMachine>
  </Sequence>
</Activity>